---
layout: post
title:  "Git笔记一"
date:   2017-12-23 23:46:13 -0400
background: '/img/posts/06.jpg'
comments: true
---
<div class="posts-container">
<h1>Git笔记一</h1>
<hr />
<blockquote>
<p>git是一款十分火热的分布式版本控制系统，它能用于管理内容修改，无论是文章内容的修改还是代码内容的修改。</p>
</blockquote>
<h2>Git简介</h2>
<p>git提供了去中心化的分布式版本库管理，即每个人的本地版本库都可以作为核心版本库。当然为了方便多人协作修改也提供了远程版本库用于提交自己的修改和更新别人的修改。git同时提供了强大快速的分支切换和合并功能，让分支管理变得十分快速和简单。还有git管理的是一个个修改，一个修改可以作为一个小版本，小版本之间可以快速的回退和前进。</p>
<h2>安装</h2>
<p>笔者是在Windows上学习git，因此以在Windows上安装Git为实例。Windows上安装Git可以从<a href="https://git-scm.com/downloads" title="Git">Git官网下载</a>,(笔者架了天梯去下载，下载速度还算正常，若下载慢或无法下载可以另寻下载源)安装完成后，在任一文件夹中右键点击Git Bash Here即可弹出git命令行窗口。
 如下图所示：
 <img src="/img/posts/window.png" alt="git命令行窗口" title="git命令行窗口" /></p>
<p>安装完成后，接下来就是注册一个用户名和一个邮箱了，该用户名和邮箱用于标识本地版本控制仓库。（将笔者的<code>kam</code>替换成你的即可）如下：</p>
<pre><code>$ git config -global user.name &quot;kam&quot;
$ git config -global user.email &quot;kam@163.com&quot;
</code></pre>

<p>注意：若仅对单个版本控制仓库指定用户名和email可以去掉-global参数</p>
<h2>创建版本库</h2>
<p>你可以选择一个合适位置即一个文件夹作为一个版本库，在该文件夹中右击Git Bash Here 键入<code>init</code>命令来初始化一个版本库（笔者选择H盘的demo_repository作为版本库）。</p>
<pre><code>$ git init
Initialized empty Git repository in H:/demo_repository/.git/
</code></pre>

<p>注意：版本库创建成功后会在文件夹根目录创建一个.git文件夹，需要勾选<code>查看隐藏文件</code>才能看到。</p>
<h2>git版本库的工作原理</h2>
<h3>如何管理修改</h3>
<blockquote>
<p>git对内容修改的管理主要通过两个步骤来实现。</p>
</blockquote>
<p>Step1，通过<code>add</code>命令将修改的内容添加至暂存区，如下新建一个Readme.txt文件。</p>
<pre><code>$ git add Readme.txt
</code></pre>

<p>注意：添加文件和删除文件也算作一个修改，修改是以整个版本库工作区为准的。还可通过<code>add .</code>命令来提交当前工作区的所有修改至暂存区中（比较实用的一个命令）。
</p>
<p>Step2，通过<code>commit</code>命令将暂存区的修改内容一次性添加至分支上。可以添加一个<code>-m</code>参数来描述修改。</p>
<pre><code>$ git commit -m &quot;我添加了一个Readme.txt文件&quot;
</code></pre>

<p>注意：为什么使用一次性这个字眼呢，因为可以多次使用<code>add</code>命令将一个个小修改提交至暂存区，而后通过<code>commit</code>合并这些小修改为一个规模大一点的修改，然后添加至分支上。一个commit就是一个版本，往后我们可以在多个commit即多个版本间回退和前进。一旦commit命令提交成功后，暂存区的内容将会被清空。</p>
<h3>版本库存储区域</h3>
<p>那么git版本库中到底有多少个存储区域呢，答案是3个。即工作区（stage）、暂存区和分支(若没有手动创建其他分支，git会为我们创建一个名为<code>master</code>的主分支)。还记得上文中提到的隐藏文件夹<code>.git</code>吗？我们的暂存区和主分支就是在该文件夹中。而工作区就是我们文件夹中所看到文件目录啦。其实真正的版本库指的是<code>.git</code>文件中的暂存区和分支啦！我们可以通过下图更加直观的了解git三个存储区域。
<img src="/img/posts/stage.png" alt="git存储区域示意图" title="git存储区域示意图" />
注意：少年/<code>少女</code>莫着急，HEAD将在后续章节中提及。</p>
<h3>修改概况</h3>
<p>在git使用过程中，我们随时可以通过<code>status</code>命令来查看当前工作区的修改概况，如下三张图分别示意工作区修改后未提交至暂存区概况、工作区修改后提交至暂存区的概况、合并暂存区修改提交至分支后的概况。</p>
<p>
工作区修改尚未添加至暂存区：
<img src="/img/posts/add-before.png" alt="工作区修改后未提交至暂存区" title="工作区修改后未提交至暂存区" /><br />
工作区修改已添加至暂存区：
<img src="/img/posts/add-after.png" alt="工作区修改后添加至暂存区后" title="工作区修改后添加至暂存区后" /><br />
合并暂存区修改提交至分支：
<img src="/img/posts/commit-after.png" alt="合并暂存区修改提交至分支后" title="合并暂存区修改提交至分支后" /></p>
<h2>版本回退</h2>
<blockquote>
<p>上文中，我们提到一个commit就是一个版本，因此我们可以在多个版本间前进和回退。</p>
</blockquote>
<p>我们可以通过<code>log</code>命令来查看版本列表，从上至下分别是最近到最远的版本记录。如下图所示，笔者一共提交了两个commit，上文中我们提及的<code>commit</code> <code>-m</code>参数的作用体现出来，<code>提交修改</code>和<code>我添加了一个Readme.txt文件</code>正是我们提交commit时的描述信息，合适的描述信息有助于区分和标记修改的内容。<code>commit</code>后接着一串很长的字符串是版本的标识ID（通过SHA1计算出来的，分布式范围内都是唯一的），标识ID在版本列表中是唯一的。</p>
<p><img src="/img/posts/commit-list.png" alt="版本记录" title="版本记录" /></p>
<p>当然嫌版本信息太长不好查看，我们可以使用<code>--pretty=oneline</code>将信息简化至一行上。</p>
<pre><code>$ git log --pretty=oneline
</code></pre>

<p>回退至上一个版本可以通过<code>reset --hard HEAD^</code>命令来完成，符号<code>^</code>代表上一个版本，以此类推上上个可以通过<code>HEAD^^</code>来标识，上上上个可以通过<code>HEAD^^^</code>，当然如果跨越的版本太多的话,如往上第100个版本，还是通过<code>HEAD~100</code>来回退比较实际。</p>
<pre><code>$ git reset --hard HEAD^
$ git reset --hard HEAD~100
</code></pre>

<p>注：git会把所有的commit即版本串成一条时间线，回退和前进是在一条时间线上进行的。
前面是回退，那前进怎么办呢？前进我们可以直接通过commit ID即标识ID来前进。</p>
<pre><code>$ git reset --hard a703798
</code></pre>

<p>注：标识ID可以不用输全，是在太长了，我们可以输入前6、7位字符就可以了，git 会自动帮我们寻找该commit。当然偷懒也要有分寸，不能仅输入前2、3位字符，这样就不唯一了。
有时候你想前进到比较新的版本，但是已经找不到commit ID了，不妨键入<code>reflog</code>来查看你之前所键入的命令，其中应该就有你要找的commit ID。git会记录你运行的每一个命令喔！</p>
<pre><code>$ git reflog
</code></pre>

<h2>撤销修改</h2>
<blockquote>
<p>人都是不完美，那不完美就会犯错误，但是git提供了一些补救措辞可以让我们撤销修改。</p>
</blockquote>
<p>上文中提到的git三个存储区域，那撤销修改自然就是针对这个三个区域的撤销。
工作区修改撤销，工作区修改撤销可以通过<code>checkout -- file</code>命令来完成。</p>
<pre><code>$ git checkout -- Readme.txt
</code></pre>

<p>注意：工作区撤销有两种情况，一种就是修改未提交至暂存区，另一种是修改提交至暂存区后。前者将工作区内容回退至当前分支上的版本。后者将工作区回退至最后一次<code>add</code>操作后的版本。总之就是回退至最后一个<code>commit</code>或<code>add</code>操作后的版本。
暂存区修改撤销，可以通过<code>reset HEAD file</code>命令来完成。</p>
<pre><code>$ git reset HEAD Readme.txt
</code></pre>

<p>当前分支修改撤销，分支上撤销修改只能通过回退版本来完成了，版本回退请参见上文。</p>
<blockquote>
<p>本博文为<a href="https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000" title="廖雪峰Git教程">廖雪峰Git教程</a>的学习简化笔记，详细知识点可参见该教程。</p>
</blockquote>
</div>
<!-- This document was created with MarkdownPad, the Markdown editor for Windows (http://markdownpad.com) -->
